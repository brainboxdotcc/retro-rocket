<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Retro Rocket OS: src/debug_ringbuffer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Retro Rocket OS
   </div>
   <div id="projectbrief">BASIC-Powered Operating System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('debug__ringbuffer_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">debug_ringbuffer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="kernel_8h.html">kernel.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abea591414b23134cfb490ed7173c0561"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#abea591414b23134cfb490ed7173c0561">ring_used</a> (const <a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *r)</td></tr>
<tr class="separator:abea591414b23134cfb490ed7173c0561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bea103d6592e9f651ba10eee514298b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a6bea103d6592e9f651ba10eee514298b">dprintf_size</a> ()</td></tr>
<tr class="separator:a6bea103d6592e9f651ba10eee514298b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3221abdb68f12f9f5f04253f0ed8849a"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a3221abdb68f12f9f5f04253f0ed8849a">ring_free</a> (const <a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *r)</td></tr>
<tr class="separator:a3221abdb68f12f9f5f04253f0ed8849a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c4cbfb553f0084e838dc25eb0fe14d8"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a7c4cbfb553f0084e838dc25eb0fe14d8">ring_advance</a> (size_t idx, size_t n, size_t cap)</td></tr>
<tr class="separator:a7c4cbfb553f0084e838dc25eb0fe14d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ded03546872ac36876c110a31dfb59"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a19ded03546872ac36876c110a31dfb59">ring_drop_one_line</a> (<a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *r)</td></tr>
<tr class="separator:a19ded03546872ac36876c110a31dfb59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2382abfcd27fbc7c82ad9a987a024447"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a2382abfcd27fbc7c82ad9a987a024447">ring_write</a> (<a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *r, const char *<a class="el" href="udp_8h.html#a5c239a1bb87b52b0f1d6d68c4749cd2a">data</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="separator:a2382abfcd27fbc7c82ad9a987a024447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94466dfec80f78fbb5235ebf4546ec6e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a94466dfec80f78fbb5235ebf4546ec6e">dprintf_buffer_init</a> (size_t cap_bytes)</td></tr>
<tr class="memdesc:a94466dfec80f78fbb5235ebf4546ec6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the global dprintf line buffer.  <a href="debug__ringbuffer_8c.html#a94466dfec80f78fbb5235ebf4546ec6e">More...</a><br /></td></tr>
<tr class="separator:a94466dfec80f78fbb5235ebf4546ec6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43be19d4b94003ebaeac63d188a6ecd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a43be19d4b94003ebaeac63d188a6ecd1">dprintf_buffer_append_line</a> (const char *line, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a43be19d4b94003ebaeac63d188a6ecd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append a single line to the dprintf buffer (whole-line eviction).  <a href="debug__ringbuffer_8c.html#a43be19d4b94003ebaeac63d188a6ecd1">More...</a><br /></td></tr>
<tr class="separator:a43be19d4b94003ebaeac63d188a6ecd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa43d4e4a426da2b1f24a42f3559cc0fd"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#aa43d4e4a426da2b1f24a42f3559cc0fd">dprintf_buffer_snapshot</a> (void)</td></tr>
<tr class="memdesc:aa43d4e4a426da2b1f24a42f3559cc0fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a contiguous, null-terminated snapshot of the debug log buffer.  <a href="debug__ringbuffer_8c.html#aa43d4e4a426da2b1f24a42f3559cc0fd">More...</a><br /></td></tr>
<tr class="separator:aa43d4e4a426da2b1f24a42f3559cc0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2ec12eed2c1d2b300dac7bbff7268dea"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debug__ringbuffer_8c.html#a2ec12eed2c1d2b300dac7bbff7268dea">dprintf_ring</a> = {0}</td></tr>
<tr class="separator:a2ec12eed2c1d2b300dac7bbff7268dea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a43be19d4b94003ebaeac63d188a6ecd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43be19d4b94003ebaeac63d188a6ecd1">&#9670;&nbsp;</a></span>dprintf_buffer_append_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dprintf_buffer_append_line </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append a single line to the dprintf buffer (whole-line eviction). </p>
<p>Appends <code>line</code> (trailing newline optional). If there is not enough free space, removes whole lines from the start (oldest data) until the new line fits. If the input is larger than the buffer capacity, only the final (cap-1) bytes are kept and a newline is forced, ensuring forward progress.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">line</td><td>Pointer to bytes to append (may be non-terminated). </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes at <code>line</code> (newline optional).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>Caller must hold the debug-log lock (or be in a safe context). </dd></dl>

</div>
</div>
<a id="a94466dfec80f78fbb5235ebf4546ec6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94466dfec80f78fbb5235ebf4546ec6e">&#9670;&nbsp;</a></span>dprintf_buffer_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dprintf_buffer_init </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cap_bytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the global dprintf line buffer. </p>
<p>Allocates a fixed-size circular buffer with <code>cap_bytes</code> capacity. If <code>cap_bytes</code> is zero, a default of 1 MiB is used. Existing content is discarded. If a prior buffer exists, it is freed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cap_bytes</td><td>Capacity in bytes (0 for 1 MiB). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success; false if allocation fails.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>Caller must hold the debug-log lock (or be in a safe context). </dd></dl>

</div>
</div>
<a id="aa43d4e4a426da2b1f24a42f3559cc0fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa43d4e4a426da2b1f24a42f3559cc0fd">&#9670;&nbsp;</a></span>dprintf_buffer_snapshot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* dprintf_buffer_snapshot </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a contiguous, null-terminated snapshot of the debug log buffer. </p>
<p>The returned string contains the entire contents of the buffer from the oldest byte to the newest, in order. It is always null-terminated. If the buffer is empty, the returned string will be an empty string.</p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a <a class="el" href="kmalloc_8h.html#aa6bcd5af56ca7ffbc761b010cbd70e39" title="Allocate memory from the kernel heap.">kmalloc()</a>'d string containing the buffer contents. Caller is responsible for <a class="el" href="kmalloc_8h.html#ab78be9148ec4aacde543a359c126cba0" title="Free previously allocated memory.">kfree()</a>'ing it. Returns NULL on allocation failure or if the buffer has not been initialised.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>Caller must hold the debug-log lock (or be in a safe context). </dd></dl>

</div>
</div>
<a id="a6bea103d6592e9f651ba10eee514298b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bea103d6592e9f651ba10eee514298b">&#9670;&nbsp;</a></span>dprintf_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t dprintf_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7c4cbfb553f0084e838dc25eb0fe14d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c4cbfb553f0084e838dc25eb0fe14d8">&#9670;&nbsp;</a></span>ring_advance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t ring_advance </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a19ded03546872ac36876c110a31dfb59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ded03546872ac36876c110a31dfb59">&#9670;&nbsp;</a></span>ring_drop_one_line()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool ring_drop_one_line </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3221abdb68f12f9f5f04253f0ed8849a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3221abdb68f12f9f5f04253f0ed8849a">&#9670;&nbsp;</a></span>ring_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t ring_free </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abea591414b23134cfb490ed7173c0561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea591414b23134cfb490ed7173c0561">&#9670;&nbsp;</a></span>ring_used()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t ring_used </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2382abfcd27fbc7c82ad9a987a024447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2382abfcd27fbc7c82ad9a987a024447">&#9670;&nbsp;</a></span>ring_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ring_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2ec12eed2c1d2b300dac7bbff7268dea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ec12eed2c1d2b300dac7bbff7268dea">&#9670;&nbsp;</a></span>dprintf_ring</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdprintf__ring__t.html">dprintf_ring_t</a> dprintf_ring = {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="debug__ringbuffer_8c.html">debug_ringbuffer.c</a></li>
    <li class="footer">Generated on Sat Sep 6 2025 02:11:13 for Retro Rocket OS by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

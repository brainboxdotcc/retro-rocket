<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Retro Rocket OS: src/net/tcp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Retro Rocket OS
   </div>
   <div id="projectbrief">BASIC-Powered Operating System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tcp_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tcp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="kernel_8h.html">kernel.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a214f25b568d9efd3d0a86bdcfe0d2616"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a214f25b568d9efd3d0a86bdcfe0d2616">tcp_state_receive_fin</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a214f25b568d9efd3d0a86bdcfe0d2616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when we receive FIN.  <a href="tcp_8c.html#a214f25b568d9efd3d0a86bdcfe0d2616">More...</a><br /></td></tr>
<tr class="separator:a214f25b568d9efd3d0a86bdcfe0d2616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a5ac590e0a9088bc8ddf519e8e0967d"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a0a5ac590e0a9088bc8ddf519e8e0967d">socket_error</a> (int error_code)</td></tr>
<tr class="memdesc:a0a5ac590e0a9088bc8ddf519e8e0967d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the error description associated with an error code.  <a href="tcp_8c.html#a0a5ac590e0a9088bc8ddf519e8e0967d">More...</a><br /></td></tr>
<tr class="separator:a0a5ac590e0a9088bc8ddf519e8e0967d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a8537cdc0fd4f4356add3b523391e2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ac9a8537cdc0fd4f4356add3b523391e2">get_isn</a> ()</td></tr>
<tr class="separator:ac9a8537cdc0fd4f4356add3b523391e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae675f3df7ce9d5ddea9050443f6f6dec"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ae675f3df7ce9d5ddea9050443f6f6dec">seq_lt</a> (uint32_t x, uint32_t y)</td></tr>
<tr class="separator:ae675f3df7ce9d5ddea9050443f6f6dec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3de4fe04475c09b292bf71bf0a175a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#aeb3de4fe04475c09b292bf71bf0a175a">seq_lte</a> (uint32_t x, uint32_t y)</td></tr>
<tr class="separator:aeb3de4fe04475c09b292bf71bf0a175a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d69668a0bae4e57c41f3657840a0956"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a5d69668a0bae4e57c41f3657840a0956">seq_gt</a> (uint32_t x, uint32_t y)</td></tr>
<tr class="separator:a5d69668a0bae4e57c41f3657840a0956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a473b7dd1cb0588bb1057164a02fc47e1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a473b7dd1cb0588bb1057164a02fc47e1">seq_gte</a> (uint32_t x, uint32_t y)</td></tr>
<tr class="separator:a473b7dd1cb0588bb1057164a02fc47e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab876210b35fe5bed3553bffff11dd349"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ab876210b35fe5bed3553bffff11dd349">tcp_conn_compare</a> (const void *a, const void *b, void *udata)</td></tr>
<tr class="memdesc:ab876210b35fe5bed3553bffff11dd349"><td class="mdescLeft">&#160;</td><td class="mdescRight">Comparison function for hash table of tcp connections.  <a href="tcp_8c.html#ab876210b35fe5bed3553bffff11dd349">More...</a><br /></td></tr>
<tr class="separator:ab876210b35fe5bed3553bffff11dd349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c33212152620295382813f3d2f31ad"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a16c33212152620295382813f3d2f31ad">tcp_conn_hash</a> (const void *item, uint64_t seed0, uint64_t seed1)</td></tr>
<tr class="memdesc:a16c33212152620295382813f3d2f31ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hash an ip connection.  <a href="tcp_8c.html#a16c33212152620295382813f3d2f31ad">More...</a><br /></td></tr>
<tr class="separator:a16c33212152620295382813f3d2f31ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc3ee20119efcc93a842946fba1ce561"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#abc3ee20119efcc93a842946fba1ce561">tcp_free</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, bool with_lock)</td></tr>
<tr class="separator:abc3ee20119efcc93a842946fba1ce561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa386730f497701efce8f9dd8f01c235e"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#aa386730f497701efce8f9dd8f01c235e">tcp_calculate_checksum</a> (ip_packet_t *packet, tcp_segment_t *segment, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="separator:aa386730f497701efce8f9dd8f01c235e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4feb883d196783f849a6372099d4a508"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a4feb883d196783f849a6372099d4a508">tcp_byte_order_in</a> (tcp_segment_t *const segment)</td></tr>
<tr class="memdesc:a4feb883d196783f849a6372099d4a508"><td class="mdescLeft">&#160;</td><td class="mdescRight">Swap byte order of an inbound packet fields to host byte order.  <a href="tcp_8c.html#a4feb883d196783f849a6372099d4a508">More...</a><br /></td></tr>
<tr class="separator:a4feb883d196783f849a6372099d4a508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33bd38a1aa07d7b8ea65ab309027b82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ad33bd38a1aa07d7b8ea65ab309027b82">tcp_byte_order_out</a> (tcp_segment_t *const segment)</td></tr>
<tr class="separator:ad33bd38a1aa07d7b8ea65ab309027b82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8102b39384be502290c55c6d9c89923"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#af8102b39384be502290c55c6d9c89923">tcp_parse_options</a> (tcp_segment_t *const segment, <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>)</td></tr>
<tr class="memdesc:af8102b39384be502290c55c6d9c89923"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse the options fields of a tcp segment into a <a class="el" href="structtcp__options__t.html">tcp_options_t</a> struct.  <a href="tcp_8c.html#af8102b39384be502290c55c6d9c89923">More...</a><br /></td></tr>
<tr class="separator:af8102b39384be502290c55c6d9c89923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace43d7dd2f9763f7a906bcf3c3114deb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ace43d7dd2f9763f7a906bcf3c3114deb">tcp_find</a> (uint32_t source_addr, uint32_t dest_addr, uint16_t source_port, uint16_t dest_port)</td></tr>
<tr class="memdesc:ace43d7dd2f9763f7a906bcf3c3114deb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a TCP TCB by source and destination address/port pairs.  <a href="tcp_8c.html#ace43d7dd2f9763f7a906bcf3c3114deb">More...</a><br /></td></tr>
<tr class="separator:ace43d7dd2f9763f7a906bcf3c3114deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f00d4a8ff9158f6a4138b531ab1379"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#aa0f00d4a8ff9158f6a4138b531ab1379">tcp_set_state</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, <a class="el" href="tcp_8h.html#a30a6f4a8caaf05f882c7c7ecb1e8d83f">tcp_state_t</a> new_state)</td></tr>
<tr class="memdesc:aa0f00d4a8ff9158f6a4138b531ab1379"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the state for a TCB.  <a href="tcp_8c.html#aa0f00d4a8ff9158f6a4138b531ab1379">More...</a><br /></td></tr>
<tr class="separator:aa0f00d4a8ff9158f6a4138b531ab1379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8a39ec6745c9f2b765820dce977185"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#aee8a39ec6745c9f2b765820dce977185">tcp_build_options</a> (uint8_t *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *opt)</td></tr>
<tr class="memdesc:aee8a39ec6745c9f2b765820dce977185"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the options for a segment before sending.  <a href="tcp_8c.html#aee8a39ec6745c9f2b765820dce977185">More...</a><br /></td></tr>
<tr class="separator:aee8a39ec6745c9f2b765820dce977185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac3e5a924fc67e6eb8b2d2d58a7f4d3c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#aac3e5a924fc67e6eb8b2d2d58a7f4d3c">tcp_send_segment</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, uint32_t <a class="el" href="tcp_8h.html#aaf1b939170b82732448a965a5b33ad4e">seq</a>, uint8_t <a class="el" href="tcp_8h.html#a24acab6663ca0c43fab3a6b82602362c">flags</a>, const void *<a class="el" href="udp_8h.html#a5c239a1bb87b52b0f1d6d68c4749cd2a">data</a>, size_t count)</td></tr>
<tr class="memdesc:aac3e5a924fc67e6eb8b2d2d58a7f4d3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a segment to the peer.  <a href="tcp_8c.html#aac3e5a924fc67e6eb8b2d2d58a7f4d3c">More...</a><br /></td></tr>
<tr class="separator:aac3e5a924fc67e6eb8b2d2d58a7f4d3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74284b0a11634f10e384e95bc9ebd803"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a74284b0a11634f10e384e95bc9ebd803">tcp_header_size</a> (tcp_segment_t *<a class="el" href="serial_8h.html#ab87f55bd0280d90925050a4188c14ab5">s</a>)</td></tr>
<tr class="memdesc:a74284b0a11634f10e384e95bc9ebd803"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate size of header for a segment using the payload offset.  <a href="tcp_8c.html#a74284b0a11634f10e384e95bc9ebd803">More...</a><br /></td></tr>
<tr class="separator:a74284b0a11634f10e384e95bc9ebd803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75032ffbabb54edf804b6103fb0c510c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a75032ffbabb54edf804b6103fb0c510c">tcp_write</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const void *<a class="el" href="udp_8h.html#a5c239a1bb87b52b0f1d6d68c4749cd2a">data</a>, size_t count)</td></tr>
<tr class="memdesc:a75032ffbabb54edf804b6103fb0c510c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write data to an open connection.  <a href="tcp_8c.html#a75032ffbabb54edf804b6103fb0c510c">More...</a><br /></td></tr>
<tr class="separator:a75032ffbabb54edf804b6103fb0c510c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fae714621be602167d457c62e33c85f"><td class="memItemLeft" align="right" valign="top">tcp_segment_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a9fae714621be602167d457c62e33c85f">tcp_ord_list_insert</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, tcp_segment_t *segment, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a9fae714621be602167d457c62e33c85f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert segment into list of segments ordered by sequence number. If this segment partially overlaps a segment in the list, that segment will be adjusted in size and this segment will overwrite it. If however the current segment's sequence number exists exactly in the list this is a duplicate segment and will be dropped.  <a href="tcp_8c.html#a9fae714621be602167d457c62e33c85f">More...</a><br /></td></tr>
<tr class="separator:a9fae714621be602167d457c62e33c85f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c672351b81d20e4c461651505752727"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a1c672351b81d20e4c461651505752727">tcp_process_queue</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, tcp_segment_t *segment, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a1c672351b81d20e4c461651505752727"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send completed sequences of segments to the recv buffer.  <a href="tcp_8c.html#a1c672351b81d20e4c461651505752727">More...</a><br /></td></tr>
<tr class="separator:a1c672351b81d20e4c461651505752727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c3e7df05a0c2e84587e765f4b43909"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a21c3e7df05a0c2e84587e765f4b43909">tcp_state_listen</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="separator:a21c3e7df05a0c2e84587e765f4b43909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a024b4a8b3ea818c47577a130b899fdbd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a024b4a8b3ea818c47577a130b899fdbd">tcp_send_ack</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn)</td></tr>
<tr class="memdesc:a024b4a8b3ea818c47577a130b899fdbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an ACK for the segments we have received so far.  <a href="tcp_8c.html#a024b4a8b3ea818c47577a130b899fdbd">More...</a><br /></td></tr>
<tr class="separator:a024b4a8b3ea818c47577a130b899fdbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a338f973fea7653505864976cdb77199a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a338f973fea7653505864976cdb77199a">tcp_send_fin_ack</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn)</td></tr>
<tr class="separator:a338f973fea7653505864976cdb77199a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a22ad65359d60c3d9563313ea07c004"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a1a22ad65359d60c3d9563313ea07c004">tcp_state_syn_sent</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a1a22ad65359d60c3d9563313ea07c004"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is SYN-SENT.  <a href="tcp_8c.html#a1a22ad65359d60c3d9563313ea07c004">More...</a><br /></td></tr>
<tr class="separator:a1a22ad65359d60c3d9563313ea07c004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6d3ca65551b99722275ec5890f16d2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#add6d3ca65551b99722275ec5890f16d2">tcp_state_syn_received</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:add6d3ca65551b99722275ec5890f16d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is SYN-RECEIVED.  <a href="tcp_8c.html#add6d3ca65551b99722275ec5890f16d2">More...</a><br /></td></tr>
<tr class="separator:add6d3ca65551b99722275ec5890f16d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04dd6209768f1bfebe055e5aa222f177"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a04dd6209768f1bfebe055e5aa222f177">tcp_state_receive_rst</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a04dd6209768f1bfebe055e5aa222f177"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when we receive RST.  <a href="tcp_8c.html#a04dd6209768f1bfebe055e5aa222f177">More...</a><br /></td></tr>
<tr class="separator:a04dd6209768f1bfebe055e5aa222f177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a745219f2cfc3cff881b8b6d441aace20"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a745219f2cfc3cff881b8b6d441aace20">tcp_handle_data_in</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a745219f2cfc3cff881b8b6d441aace20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called for general data IN that we need to ACK.  <a href="tcp_8c.html#a745219f2cfc3cff881b8b6d441aace20">More...</a><br /></td></tr>
<tr class="separator:a745219f2cfc3cff881b8b6d441aace20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383e5b445608621d0ec2805660fcf10b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a383e5b445608621d0ec2805660fcf10b">tcp_set_conn_msl_time</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn)</td></tr>
<tr class="memdesc:a383e5b445608621d0ec2805660fcf10b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set connection timeout (12 seconds)  <a href="tcp_8c.html#a383e5b445608621d0ec2805660fcf10b">More...</a><br /></td></tr>
<tr class="separator:a383e5b445608621d0ec2805660fcf10b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c0f2bbb73bca358db4c8ef67084559"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ac7c0f2bbb73bca358db4c8ef67084559">tcp_state_established</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:ac7c0f2bbb73bca358db4c8ef67084559"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is ESTABLISHED.  <a href="tcp_8c.html#ac7c0f2bbb73bca358db4c8ef67084559">More...</a><br /></td></tr>
<tr class="separator:ac7c0f2bbb73bca358db4c8ef67084559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af061b7b3b7a648a863124f700ca0b0c5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#af061b7b3b7a648a863124f700ca0b0c5">tcp_state_fin_wait_1</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:af061b7b3b7a648a863124f700ca0b0c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is FIN-WAIT-1.  <a href="tcp_8c.html#af061b7b3b7a648a863124f700ca0b0c5">More...</a><br /></td></tr>
<tr class="separator:af061b7b3b7a648a863124f700ca0b0c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a315555828672675f3ce51faac160ab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a0a315555828672675f3ce51faac160ab">tcp_state_fin_wait_2</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a0a315555828672675f3ce51faac160ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is FIN-WAIT-2.  <a href="tcp_8c.html#a0a315555828672675f3ce51faac160ab">More...</a><br /></td></tr>
<tr class="separator:a0a315555828672675f3ce51faac160ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533348445846649da136d821ffa438e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a533348445846649da136d821ffa438e4">tcp_state_close_wait</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a533348445846649da136d821ffa438e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is CLOSE-WAIT.  <a href="tcp_8c.html#a533348445846649da136d821ffa438e4">More...</a><br /></td></tr>
<tr class="separator:a533348445846649da136d821ffa438e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6035542bb9e0ba654143f88f59425acb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a6035542bb9e0ba654143f88f59425acb">tcp_state_closing</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a6035542bb9e0ba654143f88f59425acb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is CLOSING.  <a href="tcp_8c.html#a6035542bb9e0ba654143f88f59425acb">More...</a><br /></td></tr>
<tr class="separator:a6035542bb9e0ba654143f88f59425acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d4343279c0056cbfd3f6409ebb1256"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ad5d4343279c0056cbfd3f6409ebb1256">tcp_state_last_ack</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:ad5d4343279c0056cbfd3f6409ebb1256"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is LAST-ACK.  <a href="tcp_8c.html#ad5d4343279c0056cbfd3f6409ebb1256">More...</a><br /></td></tr>
<tr class="separator:ad5d4343279c0056cbfd3f6409ebb1256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44df86a0659fcbe27f20609f888cad57"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a44df86a0659fcbe27f20609f888cad57">tcp_state_time_wait</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a44df86a0659fcbe27f20609f888cad57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when state is TIME-WAIT.  <a href="tcp_8c.html#a44df86a0659fcbe27f20609f888cad57">More...</a><br /></td></tr>
<tr class="separator:a44df86a0659fcbe27f20609f888cad57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cf351cb80d4c8cc2512ad0f490893c0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a5cf351cb80d4c8cc2512ad0f490893c0">tcp_state_machine</a> (ip_packet_t *encap_packet, tcp_segment_t *segment, <a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn, const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *<a class="el" href="tcp_8h.html#a15d570669f1585f18a87d277f1753027">options</a>, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a5cf351cb80d4c8cc2512ad0f490893c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finite state machine to route segments based on current state.  <a href="tcp_8c.html#a5cf351cb80d4c8cc2512ad0f490893c0">More...</a><br /></td></tr>
<tr class="separator:a5cf351cb80d4c8cc2512ad0f490893c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d4611b68b5ca398ee9bc373573afab6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a8d4611b68b5ca398ee9bc373573afab6">tcp_handle_packet</a> ([[maybe_unused]] ip_packet_t *encap_packet, tcp_segment_t *segment, size_t <a class="el" href="tcp_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a8d4611b68b5ca398ee9bc373573afab6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle inbound packet from IP layer.  <a href="tcp_8c.html#a8d4611b68b5ca398ee9bc373573afab6">More...</a><br /></td></tr>
<tr class="separator:a8d4611b68b5ca398ee9bc373573afab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5505c46ddfafecad526d12d4d1666050"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a5505c46ddfafecad526d12d4d1666050">tcp_idle</a> ()</td></tr>
<tr class="memdesc:a5505c46ddfafecad526d12d4d1666050"><td class="mdescLeft">&#160;</td><td class="mdescRight">ISR idle task.  <a href="tcp_8c.html#a5505c46ddfafecad526d12d4d1666050">More...</a><br /></td></tr>
<tr class="separator:a5505c46ddfafecad526d12d4d1666050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e048a052cd5ec7a0bfe8734751990f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a0e048a052cd5ec7a0bfe8734751990f1">tcp_init</a> ()</td></tr>
<tr class="memdesc:a0e048a052cd5ec7a0bfe8734751990f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise TCP.  <a href="tcp_8c.html#a0e048a052cd5ec7a0bfe8734751990f1">More...</a><br /></td></tr>
<tr class="separator:a0e048a052cd5ec7a0bfe8734751990f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249d5d94734e90a3fd51b70fe4810343"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a249d5d94734e90a3fd51b70fe4810343">tcp_port_in_use</a> (uint32_t <a class="el" href="e1000_8h.html#a2cf6caf45728e5af959628648c2116fc">addr</a>, uint16_t port, <a class="el" href="tcp_8h.html#aee0c1c2ac9ad5818e178340cf8812c8e">tcp_port_type_t</a> <a class="el" href="icmp_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="memdesc:a249d5d94734e90a3fd51b70fe4810343"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if port is in use on this local address.  <a href="tcp_8c.html#a249d5d94734e90a3fd51b70fe4810343">More...</a><br /></td></tr>
<tr class="separator:a249d5d94734e90a3fd51b70fe4810343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f402771111ada0834a98e599c0bd313"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a4f402771111ada0834a98e599c0bd313">tcp_alloc_port</a> (uint32_t source_addr, uint16_t port, <a class="el" href="tcp_8h.html#aee0c1c2ac9ad5818e178340cf8812c8e">tcp_port_type_t</a> <a class="el" href="icmp_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="memdesc:a4f402771111ada0834a98e599c0bd313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a free port &gt;= 1024.  <a href="tcp_8c.html#a4f402771111ada0834a98e599c0bd313">More...</a><br /></td></tr>
<tr class="separator:a4f402771111ada0834a98e599c0bd313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ed2cdd1c291c5083404950e916c98f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ac4ed2cdd1c291c5083404950e916c98f">tcp_connect</a> (uint32_t target_addr, uint16_t target_port, uint16_t source_port)</td></tr>
<tr class="separator:ac4ed2cdd1c291c5083404950e916c98f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a616706131cb20d379279872ca4af8e71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a616706131cb20d379279872ca4af8e71">tcp_close</a> (<a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *conn)</td></tr>
<tr class="separator:a616706131cb20d379279872ca4af8e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5787e23039c4a2243cbc968a48431d2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a5787e23039c4a2243cbc968a48431d2e">send</a> (int socket, const void *<a class="el" href="input_8c.html#aff2566f4c366b48d73479bef43ee4d2e">buffer</a>, uint32_t <a class="el" href="udp_8h.html#a1892eba2086d12ac2b09005aeb09ea3b">length</a>)</td></tr>
<tr class="memdesc:a5787e23039c4a2243cbc968a48431d2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data to an open socket.  <a href="tcp_8c.html#a5787e23039c4a2243cbc968a48431d2e">More...</a><br /></td></tr>
<tr class="separator:a5787e23039c4a2243cbc968a48431d2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a95723a63184d3eb69a619853f560da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a4a95723a63184d3eb69a619853f560da">connect</a> (uint32_t target_addr, uint16_t target_port, uint16_t source_port, bool blocking)</td></tr>
<tr class="memdesc:a4a95723a63184d3eb69a619853f560da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect to a TCP port at a given IPv4 address.  <a href="tcp_8c.html#a4a95723a63184d3eb69a619853f560da">More...</a><br /></td></tr>
<tr class="separator:a4a95723a63184d3eb69a619853f560da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4725afcb96cfe437fd7a748129b1f33"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ad4725afcb96cfe437fd7a748129b1f33">closesocket</a> (int socket)</td></tr>
<tr class="memdesc:ad4725afcb96cfe437fd7a748129b1f33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close a TCP connection.  <a href="tcp_8c.html#ad4725afcb96cfe437fd7a748129b1f33">More...</a><br /></td></tr>
<tr class="separator:ad4725afcb96cfe437fd7a748129b1f33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39bac2a3c55fa01613ed4a5579a5ca67"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a39bac2a3c55fa01613ed4a5579a5ca67">is_connected</a> (int socket)</td></tr>
<tr class="memdesc:a39bac2a3c55fa01613ed4a5579a5ca67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the socket is connected.  <a href="tcp_8c.html#a39bac2a3c55fa01613ed4a5579a5ca67">More...</a><br /></td></tr>
<tr class="separator:a39bac2a3c55fa01613ed4a5579a5ca67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df7b901b1a9f3ec7046f958f9e7cf36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a6df7b901b1a9f3ec7046f958f9e7cf36">recv</a> (int socket, void *<a class="el" href="input_8c.html#aff2566f4c366b48d73479bef43ee4d2e">buffer</a>, uint32_t maxlen, bool blocking, uint32_t timeout)</td></tr>
<tr class="memdesc:a6df7b901b1a9f3ec7046f958f9e7cf36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data from an open socket. The data is buffered, and this function will fill the buffer when there is data in the buffer to read.  <a href="tcp_8c.html#a6df7b901b1a9f3ec7046f958f9e7cf36">More...</a><br /></td></tr>
<tr class="separator:a6df7b901b1a9f3ec7046f958f9e7cf36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4013d43c90be7603c80e7224765d830"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ae4013d43c90be7603c80e7224765d830">sock_ready_to_read</a> (int socket)</td></tr>
<tr class="memdesc:ae4013d43c90be7603c80e7224765d830"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a socket has data ready to be read.  <a href="tcp_8c.html#ae4013d43c90be7603c80e7224765d830">More...</a><br /></td></tr>
<tr class="separator:ae4013d43c90be7603c80e7224765d830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab30a0d5f82ac8f116897d82578ae25eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#ab30a0d5f82ac8f116897d82578ae25eb">tcp_listen</a> (uint32_t <a class="el" href="e1000_8h.html#a2cf6caf45728e5af959628648c2116fc">addr</a>, uint16_t port, int backlog)</td></tr>
<tr class="memdesc:ab30a0d5f82ac8f116897d82578ae25eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a listening TCP socket.  <a href="tcp_8c.html#ab30a0d5f82ac8f116897d82578ae25eb">More...</a><br /></td></tr>
<tr class="separator:ab30a0d5f82ac8f116897d82578ae25eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb880bf940312acdf8a48c4d4dfa0b72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#aeb880bf940312acdf8a48c4d4dfa0b72">tcp_accept</a> (int socket)</td></tr>
<tr class="memdesc:aeb880bf940312acdf8a48c4d4dfa0b72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept an incoming connection on a listening socket.  <a href="tcp_8c.html#aeb880bf940312acdf8a48c4d4dfa0b72">More...</a><br /></td></tr>
<tr class="separator:aeb880bf940312acdf8a48c4d4dfa0b72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6f8f49bc3c11eb24ddb9df2b777d1767"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structhashmap.html">hashmap</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a6f8f49bc3c11eb24ddb9df2b777d1767">tcb</a> = NULL</td></tr>
<tr class="separator:a6f8f49bc3c11eb24ddb9df2b777d1767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81e9011a484999b346bdd1c85e26ba97"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a81e9011a484999b346bdd1c85e26ba97">isn_rand_base</a> = 0</td></tr>
<tr class="separator:a81e9011a484999b346bdd1c85e26ba97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18d0f3d97e3f13b56d8ce3c40d73f5ed"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a18d0f3d97e3f13b56d8ce3c40d73f5ed">isn_tick_base</a> = 0</td></tr>
<tr class="separator:a18d0f3d97e3f13b56d8ce3c40d73f5ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c9b5d9f7b9b8b0360a9cc2a9db5a904"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a0c9b5d9f7b9b8b0360a9cc2a9db5a904">isn_init</a> = 0</td></tr>
<tr class="separator:a0c9b5d9f7b9b8b0360a9cc2a9db5a904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79cda015c79ff2b4c1444e3070f0bb5d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="spinlock_8h.html#af82eed01f0304d83276dda764b213779">spinlock_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a79cda015c79ff2b4c1444e3070f0bb5d">lock</a> = 0</td></tr>
<tr class="separator:a79cda015c79ff2b4c1444e3070f0bb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04d6c5aa1480297be289c658666c01f1"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tcp_8c.html#a04d6c5aa1480297be289c658666c01f1">error_messages</a> []</td></tr>
<tr class="separator:a04d6c5aa1480297be289c658666c01f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad4725afcb96cfe437fd7a748129b1f33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4725afcb96cfe437fd7a748129b1f33">&#9670;&nbsp;</a></span>closesocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int closesocket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close a TCP connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>socket descriptor to close </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero on success, error code on error </dd></dl>

</div>
</div>
<a id="a4a95723a63184d3eb69a619853f560da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a95723a63184d3eb69a619853f560da">&#9670;&nbsp;</a></span>connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connect </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>target_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>target_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>source_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>blocking</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect to a TCP port at a given IPv4 address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_addr</td><td>Target address to connect to </td></tr>
    <tr><td class="paramname">target_port</td><td>Target port to connect to </td></tr>
    <tr><td class="paramname">source_port</td><td>Our source port to use, or 0 to choose automatically </td></tr>
    <tr><td class="paramname">blocking</td><td>Set to true if this call is to block until the connection is established or errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero or positive file descriptor number on success, negative for error </dd></dl>

</div>
</div>
<a id="ac9a8537cdc0fd4f4356add3b523391e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a8537cdc0fd4f4356add3b523391e2">&#9670;&nbsp;</a></span>get_isn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t get_isn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a39bac2a3c55fa01613ed4a5579a5ca67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39bac2a3c55fa01613ed4a5579a5ca67">&#9670;&nbsp;</a></span>is_connected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_connected </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the socket is connected. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>socket descriptor from <a class="el" href="tcp_8h.html#a4a95723a63184d3eb69a619853f560da" title="Connect to a TCP port at a given IPv4 address.">connect()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if socket is connected, false if not. This will return false if <a class="el" href="tcp_8h.html#a4a95723a63184d3eb69a619853f560da" title="Connect to a TCP port at a given IPv4 address.">connect()</a> hasn't succeeded yet. </dd></dl>

</div>
</div>
<a id="a6df7b901b1a9f3ec7046f958f9e7cf36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df7b901b1a9f3ec7046f958f9e7cf36">&#9670;&nbsp;</a></span>recv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int recv </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>blocking</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive data from an open socket. The data is buffered, and this function will fill the buffer when there is data in the buffer to read. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>socket descriptor from <a class="el" href="tcp_8h.html#a4a95723a63184d3eb69a619853f560da" title="Connect to a TCP port at a given IPv4 address.">connect()</a> </td></tr>
    <tr><td class="paramname">buffer</td><td>buffer to receive data to </td></tr>
    <tr><td class="paramname">maxlen</td><td>maximum size of data to receive to buffer </td></tr>
    <tr><td class="paramname">blocking</td><td>true if this call should block until the buffer has data </td></tr>
    <tr><td class="paramname">timeout</td><td>read timeout when blocking (seconds) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int number of bytes received </dd></dl>

</div>
</div>
<a id="a5787e23039c4a2243cbc968a48431d2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5787e23039c4a2243cbc968a48431d2e">&#9670;&nbsp;</a></span>send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data to an open socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>socket descriptor from <a class="el" href="tcp_8h.html#a4a95723a63184d3eb69a619853f560da" title="Connect to a TCP port at a given IPv4 address.">connect()</a> </td></tr>
    <tr><td class="paramname">buffer</td><td>buffer to send </td></tr>
    <tr><td class="paramname">length</td><td>number of bytes to send </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int number of bytes written </dd></dl>

</div>
</div>
<a id="a5d69668a0bae4e57c41f3657840a0956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d69668a0bae4e57c41f3657840a0956">&#9670;&nbsp;</a></span>seq_gt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool seq_gt </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a473b7dd1cb0588bb1057164a02fc47e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a473b7dd1cb0588bb1057164a02fc47e1">&#9670;&nbsp;</a></span>seq_gte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool seq_gte </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae675f3df7ce9d5ddea9050443f6f6dec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae675f3df7ce9d5ddea9050443f6f6dec">&#9670;&nbsp;</a></span>seq_lt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool seq_lt </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb3de4fe04475c09b292bf71bf0a175a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb3de4fe04475c09b292bf71bf0a175a">&#9670;&nbsp;</a></span>seq_lte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool seq_lte </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae4013d43c90be7603c80e7224765d830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4013d43c90be7603c80e7224765d830">&#9670;&nbsp;</a></span>sock_ready_to_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sock_ready_to_read </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a socket has data ready to be read. </p>
<p>Non-blocking check for buffered data on the given socket. Does not consume any data or modify the recv buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>File descriptor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if there is data available to read, false otherwise </dd></dl>

</div>
</div>
<a id="a0a5ac590e0a9088bc8ddf519e8e0967d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a5ac590e0a9088bc8ddf519e8e0967d">&#9670;&nbsp;</a></span>socket_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* socket_error </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>error_code</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the error description associated with an error code. </p>
<dl class="section note"><dt>Note</dt><dd>Invalid error codes return the constant "No error".</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">error_code</td><td>error code </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>const char* description </dd></dl>

</div>
</div>
<a id="aeb880bf940312acdf8a48c4d4dfa0b72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb880bf940312acdf8a48c4d4dfa0b72">&#9670;&nbsp;</a></span>tcp_accept()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_accept </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept an incoming connection on a listening socket. </p>
<p>Removes one pending connection from the listening sockets queue and allocates a new file descriptor for it. The connection will be in the ESTABLISHED state upon return.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>File descriptor of a socket previously placed in the LISTEN state using <a class="el" href="tcp_8h.html#ab30a0d5f82ac8f116897d82578ae25eb" title="Create a listening TCP socket.">tcp_listen()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>File descriptor for the accepted connection on success, or a negative TCP_ERROR code on failure. </dd></dl>

</div>
</div>
<a id="a4f402771111ada0834a98e599c0bd313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f402771111ada0834a98e599c0bd313">&#9670;&nbsp;</a></span>tcp_alloc_port()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t tcp_alloc_port </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>source_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#aee0c1c2ac9ad5818e178340cf8812c8e">tcp_port_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a free port &gt;= 1024. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source_addr</td><td>source address </td></tr>
    <tr><td class="paramname">port</td><td>port, 0 to let the system choose </td></tr>
    <tr><td class="paramname">type</td><td>type of port, local or remote </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint16_t selected port, or 0 if none available </dd></dl>

</div>
</div>
<a id="aee8a39ec6745c9f2b765820dce977185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee8a39ec6745c9f2b765820dce977185">&#9670;&nbsp;</a></span>tcp_build_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t tcp_build_options </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the options for a segment before sending. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">options</td><td>options pointer to fill </td></tr>
    <tr><td class="paramname">opt</td><td>options values to set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t number of bytes filled </dd></dl>

</div>
</div>
<a id="a4feb883d196783f849a6372099d4a508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4feb883d196783f849a6372099d4a508">&#9670;&nbsp;</a></span>tcp_byte_order_in()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_byte_order_in </td>
          <td>(</td>
          <td class="paramtype">tcp_segment_t *const&#160;</td>
          <td class="paramname"><em>segment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Swap byte order of an inbound packet fields to host byte order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">segment</td><td>segment to swap byte order for </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad33bd38a1aa07d7b8ea65ab309027b82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad33bd38a1aa07d7b8ea65ab309027b82">&#9670;&nbsp;</a></span>tcp_byte_order_out()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_byte_order_out </td>
          <td>(</td>
          <td class="paramtype">tcp_segment_t *const&#160;</td>
          <td class="paramname"><em>segment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa386730f497701efce8f9dd8f01c235e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa386730f497701efce8f9dd8f01c235e">&#9670;&nbsp;</a></span>tcp_calculate_checksum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t tcp_calculate_checksum </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a616706131cb20d379279872ca4af8e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a616706131cb20d379279872ca4af8e71">&#9670;&nbsp;</a></span>tcp_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab876210b35fe5bed3553bffff11dd349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab876210b35fe5bed3553bffff11dd349">&#9670;&nbsp;</a></span>tcp_conn_compare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_conn_compare </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>udata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Comparison function for hash table of tcp connections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>first object to compare </td></tr>
    <tr><td class="paramname">b</td><td>second object to compare </td></tr>
    <tr><td class="paramname">udata</td><td>user data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0 for equal, 1 for not equal </dd></dl>

</div>
</div>
<a id="a16c33212152620295382813f3d2f31ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16c33212152620295382813f3d2f31ad">&#9670;&nbsp;</a></span>tcp_conn_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t tcp_conn_hash </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>item</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>seed0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>seed1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hash an ip connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">item</td><td>item to hash </td></tr>
    <tr><td class="paramname">seed0</td><td>first seed from hashmap </td></tr>
    <tr><td class="paramname">seed1</td><td>second seed from hashmap </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint64_t hash bucket value </dd></dl>

</div>
</div>
<a id="ac4ed2cdd1c291c5083404950e916c98f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4ed2cdd1c291c5083404950e916c98f">&#9670;&nbsp;</a></span>tcp_connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_connect </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>target_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>target_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>source_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ace43d7dd2f9763f7a906bcf3c3114deb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace43d7dd2f9763f7a906bcf3c3114deb">&#9670;&nbsp;</a></span>tcp_find()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a>* tcp_find </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>source_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>dest_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>source_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>dest_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find a TCP TCB by source and destination address/port pairs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">source_addr</td><td>source address </td></tr>
    <tr><td class="paramname">dest_addr</td><td>destination addres </td></tr>
    <tr><td class="paramname">source_port</td><td>source port </td></tr>
    <tr><td class="paramname">dest_port</td><td>destination port </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tcp_conn_t* TCB </dd></dl>

</div>
</div>
<a id="abc3ee20119efcc93a842946fba1ce561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc3ee20119efcc93a842946fba1ce561">&#9670;&nbsp;</a></span>tcp_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>with_lock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a745219f2cfc3cff881b8b6d441aace20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a745219f2cfc3cff881b8b6d441aace20">&#9670;&nbsp;</a></span>tcp_handle_data_in()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_handle_data_in </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called for general data IN that we need to ACK. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a8d4611b68b5ca398ee9bc373573afab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d4611b68b5ca398ee9bc373573afab6">&#9670;&nbsp;</a></span>tcp_handle_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_handle_packet </td>
          <td>(</td>
          <td class="paramtype">[[maybe_unused] ] ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle inbound packet from IP layer. </p>
<p>TCP handler called by the IP layer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a74284b0a11634f10e384e95bc9ebd803"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74284b0a11634f10e384e95bc9ebd803">&#9670;&nbsp;</a></span>tcp_header_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t tcp_header_size </td>
          <td>(</td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate size of header for a segment using the payload offset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>TCP segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t size of header </dd></dl>

</div>
</div>
<a id="a5505c46ddfafecad526d12d4d1666050"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5505c46ddfafecad526d12d4d1666050">&#9670;&nbsp;</a></span>tcp_idle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_idle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ISR idle task. </p>
<p>Idle loop ran from timer ISR. </p>

</div>
</div>
<a id="a0e048a052cd5ec7a0bfe8734751990f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e048a052cd5ec7a0bfe8734751990f1">&#9670;&nbsp;</a></span>tcp_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise TCP. </p>
<p>Initialise TCP protocol, must happen after IP. </p>

</div>
</div>
<a id="ab30a0d5f82ac8f116897d82578ae25eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab30a0d5f82ac8f116897d82578ae25eb">&#9670;&nbsp;</a></span>tcp_listen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_listen </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>backlog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a listening TCP socket. </p>
<p>Binds a TCP connection control block (TCB) to the given local address and port, and transitions it into the LISTEN state. A pending connection queue is created to hold halfopen connections until they are accepted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>Local IPv4 address to bind to (network byte order). </td></tr>
    <tr><td class="paramname">port</td><td>Local TCP port to listen on (host byte order). </td></tr>
    <tr><td class="paramname">backlog</td><td>Maximum number of pending connections that may be queued.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>File descriptor for the listening socket on success, or a negative TCP_ERROR code on failure. </dd></dl>

</div>
</div>
<a id="a9fae714621be602167d457c62e33c85f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fae714621be602167d457c62e33c85f">&#9670;&nbsp;</a></span>tcp_ord_list_insert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tcp_segment_t* tcp_ord_list_insert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert segment into list of segments ordered by sequence number. If this segment partially overlaps a segment in the list, that segment will be adjusted in size and this segment will overwrite it. If however the current segment's sequence number exists exactly in the list this is a duplicate segment and will be dropped. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>tcp connection </td></tr>
    <tr><td class="paramname">segment</td><td>tcp segment </td></tr>
    <tr><td class="paramname">len</td><td>length of tcp segment payload </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tcp_segment_t* newly inserted copy of segment on success, or NULL </dd></dl>

</div>
</div>
<a id="af8102b39384be502290c55c6d9c89923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8102b39384be502290c55c6d9c89923">&#9670;&nbsp;</a></span>tcp_parse_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t tcp_parse_options </td>
          <td>(</td>
          <td class="paramtype">tcp_segment_t *const&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse the options fields of a tcp segment into a <a class="el" href="structtcp__options__t.html">tcp_options_t</a> struct. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">segment</td><td>segment to parse </td></tr>
    <tr><td class="paramname">options</td><td>options struct to fill </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of recognised options found </dd></dl>

</div>
</div>
<a id="a249d5d94734e90a3fd51b70fe4810343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249d5d94734e90a3fd51b70fe4810343">&#9670;&nbsp;</a></span>tcp_port_in_use()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_port_in_use </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#aee0c1c2ac9ad5818e178340cf8812c8e">tcp_port_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return true if port is in use on this local address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>local address </td></tr>
    <tr><td class="paramname">port</td><td>port number </td></tr>
    <tr><td class="paramname">type</td><td>port type, local or remote </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if port is in use </dd></dl>

</div>
</div>
<a id="a1c672351b81d20e4c461651505752727"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c672351b81d20e4c461651505752727">&#9670;&nbsp;</a></span>tcp_process_queue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_process_queue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send completed sequences of segments to the recv buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a024b4a8b3ea818c47577a130b899fdbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a024b4a8b3ea818c47577a130b899fdbd">&#9670;&nbsp;</a></span>tcp_send_ack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_send_ack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an ACK for the segments we have received so far. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on successfully queueing the segment </dd></dl>

</div>
</div>
<a id="a338f973fea7653505864976cdb77199a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a338f973fea7653505864976cdb77199a">&#9670;&nbsp;</a></span>tcp_send_fin_ack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_send_fin_ack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aac3e5a924fc67e6eb8b2d2d58a7f4d3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac3e5a924fc67e6eb8b2d2d58a7f4d3c">&#9670;&nbsp;</a></span>tcp_send_segment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a>* tcp_send_segment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a segment to the peer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">seq</td><td>send sequence number </td></tr>
    <tr><td class="paramname">flags</td><td>header flags </td></tr>
    <tr><td class="paramname">data</td><td>data to send </td></tr>
    <tr><td class="paramname">count</td><td>number of octets of data to send </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tcp_conn_t* modified TCB </dd></dl>

</div>
</div>
<a id="a383e5b445608621d0ec2805660fcf10b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a383e5b445608621d0ec2805660fcf10b">&#9670;&nbsp;</a></span>tcp_set_conn_msl_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tcp_set_conn_msl_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set connection timeout (12 seconds) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa0f00d4a8ff9158f6a4138b531ab1379"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0f00d4a8ff9158f6a4138b531ab1379">&#9670;&nbsp;</a></span>tcp_set_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a>* tcp_set_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#a30a6f4a8caaf05f882c7c7ecb1e8d83f">tcp_state_t</a>&#160;</td>
          <td class="paramname"><em>new_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the state for a TCB. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">new_state</td><td>new state to set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tcp_conn_t* modified TCB </dd></dl>

</div>
</div>
<a id="a533348445846649da136d821ffa438e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533348445846649da136d821ffa438e4">&#9670;&nbsp;</a></span>tcp_state_close_wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_close_wait </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is CLOSE-WAIT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a6035542bb9e0ba654143f88f59425acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6035542bb9e0ba654143f88f59425acb">&#9670;&nbsp;</a></span>tcp_state_closing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_closing </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is CLOSING. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="ac7c0f2bbb73bca358db4c8ef67084559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c0f2bbb73bca358db4c8ef67084559">&#9670;&nbsp;</a></span>tcp_state_established()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_established </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is ESTABLISHED. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="af061b7b3b7a648a863124f700ca0b0c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af061b7b3b7a648a863124f700ca0b0c5">&#9670;&nbsp;</a></span>tcp_state_fin_wait_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_fin_wait_1 </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is FIN-WAIT-1. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a0a315555828672675f3ce51faac160ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a315555828672675f3ce51faac160ab">&#9670;&nbsp;</a></span>tcp_state_fin_wait_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_fin_wait_2 </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is FIN-WAIT-2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="ad5d4343279c0056cbfd3f6409ebb1256"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d4343279c0056cbfd3f6409ebb1256">&#9670;&nbsp;</a></span>tcp_state_last_ack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_last_ack </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is LAST-ACK. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a21c3e7df05a0c2e84587e765f4b43909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c3e7df05a0c2e84587e765f4b43909">&#9670;&nbsp;</a></span>tcp_state_listen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_listen </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5cf351cb80d4c8cc2512ad0f490893c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cf351cb80d4c8cc2512ad0f490893c0">&#9670;&nbsp;</a></span>tcp_state_machine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_machine </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finite state machine to route segments based on current state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a214f25b568d9efd3d0a86bdcfe0d2616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a214f25b568d9efd3d0a86bdcfe0d2616">&#9670;&nbsp;</a></span>tcp_state_receive_fin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_receive_fin </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when we receive FIN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a04dd6209768f1bfebe055e5aa222f177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04dd6209768f1bfebe055e5aa222f177">&#9670;&nbsp;</a></span>tcp_state_receive_rst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_receive_rst </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when we receive RST. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="add6d3ca65551b99722275ec5890f16d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add6d3ca65551b99722275ec5890f16d2">&#9670;&nbsp;</a></span>tcp_state_syn_received()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_syn_received </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is SYN-RECEIVED. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a1a22ad65359d60c3d9563313ea07c004"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a22ad65359d60c3d9563313ea07c004">&#9670;&nbsp;</a></span>tcp_state_syn_sent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_syn_sent </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is SYN-SENT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a44df86a0659fcbe27f20609f888cad57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44df86a0659fcbe27f20609f888cad57">&#9670;&nbsp;</a></span>tcp_state_time_wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tcp_state_time_wait </td>
          <td>(</td>
          <td class="paramtype">ip_packet_t *&#160;</td>
          <td class="paramname"><em>encap_packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_segment_t *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtcp__options__t.html">tcp_options_t</a> *&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when state is TIME-WAIT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">encap_packet</td><td>encapsulating IP packet </td></tr>
    <tr><td class="paramname">segment</td><td>TCP segment </td></tr>
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">options</td><td>options, e.g. MSS </td></tr>
    <tr><td class="paramname">len</td><td>length of segment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if we are to continue processing </dd></dl>

</div>
</div>
<a id="a75032ffbabb54edf804b6103fb0c510c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75032ffbabb54edf804b6103fb0c510c">&#9670;&nbsp;</a></span>tcp_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tcp_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtcp__conn__t.html">tcp_conn_t</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write data to an open connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>TCB </td></tr>
    <tr><td class="paramname">data</td><td>data to send </td></tr>
    <tr><td class="paramname">count</td><td>number of octets to send </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int zero on success, negative value on failure </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a04d6c5aa1480297be289c658666c01f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04d6c5aa1480297be289c658666c01f1">&#9670;&nbsp;</a></span>error_messages</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* error_messages[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <span class="stringliteral">&quot;Socket is already closing&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Port in use&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Network is down&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Invalid connection&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Write too large&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Socket not connected&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Out of socket descriptors&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Out of memory&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Invalid socket descriptor&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Connection failed&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Socket not listening&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Accept would block&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;Connection timed out&quot;</span>,</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c9b5d9f7b9b8b0360a9cc2a9db5a904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c9b5d9f7b9b8b0360a9cc2a9db5a904">&#9670;&nbsp;</a></span>isn_init</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int isn_init = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a81e9011a484999b346bdd1c85e26ba97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81e9011a484999b346bdd1c85e26ba97">&#9670;&nbsp;</a></span>isn_rand_base</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t isn_rand_base = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a18d0f3d97e3f13b56d8ce3c40d73f5ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18d0f3d97e3f13b56d8ce3c40d73f5ed">&#9670;&nbsp;</a></span>isn_tick_base</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t isn_tick_base = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a79cda015c79ff2b4c1444e3070f0bb5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79cda015c79ff2b4c1444e3070f0bb5d">&#9670;&nbsp;</a></span>lock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="spinlock_8h.html#af82eed01f0304d83276dda764b213779">spinlock_t</a> lock = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6f8f49bc3c11eb24ddb9df2b777d1767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f8f49bc3c11eb24ddb9df2b777d1767">&#9670;&nbsp;</a></span>tcb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structhashmap.html">hashmap</a>* tcb = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c72b25b75abe208498b36a3e44a3726c.html">net</a></li><li class="navelem"><a class="el" href="tcp_8c.html">tcp.c</a></li>
    <li class="footer">Generated on Sat Sep 6 2025 02:14:11 for Retro Rocket OS by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

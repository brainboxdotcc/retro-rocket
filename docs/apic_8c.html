<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Retro Rocket Kernel: apic.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Retro Rocket Kernel
   </div>
   <div id="projectbrief">BASIC-Powered Operating System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('apic_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">apic.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="kernel_8h.html">kernel.h</a>&gt;</code><br />
<code>#include &lt;cpuid.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3dac42d568d070ca6f076841c4ef835a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a3dac42d568d070ca6f076841c4ef835a">IA32_APIC_BASE_MSR</a>&#160;&#160;&#160;0x1B</td></tr>
<tr class="separator:a3dac42d568d070ca6f076841c4ef835a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41621e98a2c9aed8650bf47c9b9a8861"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a41621e98a2c9aed8650bf47c9b9a8861">APIC_BASE_X2APIC_ENABLE</a>&#160;&#160;&#160;(1ULL &lt;&lt; 10)</td></tr>
<tr class="separator:a41621e98a2c9aed8650bf47c9b9a8861"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a19b8b3ead84a068bb923f912b3cb6d6c"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a19b8b3ead84a068bb923f912b3cb6d6c">get_lapic_address</a> ()</td></tr>
<tr class="memdesc:a19b8b3ead84a068bb923f912b3cb6d6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the physical address of the Local APIC MMIO region.  <a href="apic_8c.html#a19b8b3ead84a068bb923f912b3cb6d6c">More...</a><br /></td></tr>
<tr class="separator:a19b8b3ead84a068bb923f912b3cb6d6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c1212d5f2acb0c6b937827a58a4f995"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a5c1212d5f2acb0c6b937827a58a4f995">wrmsr</a> (uint32_t msr, uint64_t value)</td></tr>
<tr class="separator:a5c1212d5f2acb0c6b937827a58a4f995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a338fb9dae0af159d69fd10623f80efb1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a338fb9dae0af159d69fd10623f80efb1">apic_write</a> (uint64_t reg, uint32_t val)</td></tr>
<tr class="memdesc:a338fb9dae0af159d69fd10623f80efb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write to a Local APIC register.  <a href="apic_8c.html#a338fb9dae0af159d69fd10623f80efb1">More...</a><br /></td></tr>
<tr class="separator:a338fb9dae0af159d69fd10623f80efb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f511a07dc31003992395be20746b519"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a1f511a07dc31003992395be20746b519">apic_read</a> (uint64_t reg)</td></tr>
<tr class="memdesc:a1f511a07dc31003992395be20746b519"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a Local APIC register.  <a href="apic_8c.html#a1f511a07dc31003992395be20746b519">More...</a><br /></td></tr>
<tr class="separator:a1f511a07dc31003992395be20746b519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae432e81c207ce0b8e9c880bd3c89eb33"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#ae432e81c207ce0b8e9c880bd3c89eb33">cpu_id</a> (void)</td></tr>
<tr class="memdesc:ae432e81c207ce0b8e9c880bd3c89eb33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Local APIC ID of the current CPU.  <a href="apic_8c.html#ae432e81c207ce0b8e9c880bd3c89eb33">More...</a><br /></td></tr>
<tr class="separator:ae432e81c207ce0b8e9c880bd3c89eb33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b661f6d8fb7bf5b98900736716e6957"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a4b661f6d8fb7bf5b98900736716e6957">logical_cpu_id</a> (void)</td></tr>
<tr class="memdesc:a4b661f6d8fb7bf5b98900736716e6957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the OS-assigned logical CPU ID of the current CPU.  <a href="apic_8c.html#a4b661f6d8fb7bf5b98900736716e6957">More...</a><br /></td></tr>
<tr class="separator:a4b661f6d8fb7bf5b98900736716e6957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abce401f079aedc55879daff1d981fe74"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#abce401f079aedc55879daff1d981fe74">rdmsr</a> (uint32_t msr)</td></tr>
<tr class="memdesc:abce401f079aedc55879daff1d981fe74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a 64-bit Model Specific Register (MSR).  <a href="apic_8c.html#abce401f079aedc55879daff1d981fe74">More...</a><br /></td></tr>
<tr class="separator:abce401f079aedc55879daff1d981fe74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fd8a52f0de9d5cb7f11abc96af02e04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a5fd8a52f0de9d5cb7f11abc96af02e04">x2apic_supported</a> (void)</td></tr>
<tr class="separator:a5fd8a52f0de9d5cb7f11abc96af02e04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe067e3cf6c101bb76e395bd916e2d9d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#abe067e3cf6c101bb76e395bd916e2d9d">x2apic_enabled</a> (void)</td></tr>
<tr class="memdesc:abe067e3cf6c101bb76e395bd916e2d9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if x2APIC mode is enabled.  <a href="apic_8c.html#abe067e3cf6c101bb76e395bd916e2d9d">More...</a><br /></td></tr>
<tr class="separator:abe067e3cf6c101bb76e395bd916e2d9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed383d44eb512de5ffda7e40b60dd54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#a4ed383d44eb512de5ffda7e40b60dd54">apic_send_ipi</a> (uint32_t lapic_id, uint8_t <a class="el" href="structvector.html">vector</a>)</td></tr>
<tr class="memdesc:a4ed383d44eb512de5ffda7e40b60dd54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an Inter-Processor Interrupt (IPI) to a specific LAPIC ID.  <a href="apic_8c.html#a4ed383d44eb512de5ffda7e40b60dd54">More...</a><br /></td></tr>
<tr class="separator:a4ed383d44eb512de5ffda7e40b60dd54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e5a39ff990b4f143ec56a9915f97c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#ab9e5a39ff990b4f143ec56a9915f97c1">wake_cpu</a> (uint8_t <a class="el" href="apic_8c.html#a4b661f6d8fb7bf5b98900736716e6957">logical_cpu_id</a>)</td></tr>
<tr class="memdesc:ab9e5a39ff990b4f143ec56a9915f97c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a wake-up IPI to a target logical CPU.  <a href="apic_8c.html#ab9e5a39ff990b4f143ec56a9915f97c1">More...</a><br /></td></tr>
<tr class="separator:ab9e5a39ff990b4f143ec56a9915f97c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7f4cf430c05d00d25c8c5fb5b030bf8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="apic_8c.html#ad7f4cf430c05d00d25c8c5fb5b030bf8">apic_setup_ap</a> ()</td></tr>
<tr class="memdesc:ad7f4cf430c05d00d25c8c5fb5b030bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the Local APIC on an Application Processor (AP).  <a href="apic_8c.html#ad7f4cf430c05d00d25c8c5fb5b030bf8">More...</a><br /></td></tr>
<tr class="separator:ad7f4cf430c05d00d25c8c5fb5b030bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a41621e98a2c9aed8650bf47c9b9a8861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41621e98a2c9aed8650bf47c9b9a8861">&#9670;&nbsp;</a></span>APIC_BASE_X2APIC_ENABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APIC_BASE_X2APIC_ENABLE&#160;&#160;&#160;(1ULL &lt;&lt; 10)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3dac42d568d070ca6f076841c4ef835a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dac42d568d070ca6f076841c4ef835a">&#9670;&nbsp;</a></span>IA32_APIC_BASE_MSR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IA32_APIC_BASE_MSR&#160;&#160;&#160;0x1B</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1f511a07dc31003992395be20746b519"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f511a07dc31003992395be20746b519">&#9670;&nbsp;</a></span>apic_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t apic_read </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>reg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a Local APIC register. </p>
<p>Works in both xAPIC and x2APIC modes:</p><ul>
<li>In xAPIC mode, the register is memory‑mapped at the LAPIC base address.</li>
<li>In x2APIC mode, registers are accessed via MSRs at 0x800 + (reg &gt;&gt; 4).</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reg</td><td>Register offset (e.g. APIC_TPR = 0x80). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t Value read from the register. </dd></dl>

</div>
</div>
<a id="a4ed383d44eb512de5ffda7e40b60dd54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed383d44eb512de5ffda7e40b60dd54">&#9670;&nbsp;</a></span>apic_send_ipi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apic_send_ipi </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>lapic_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an Inter-Processor Interrupt (IPI) to a specific LAPIC ID. </p>
<p>Supports both xAPIC (ICR registers) and x2APIC (IA32_X2APIC_ICR MSR).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lapic_id</td><td>Destination LAPIC ID. </td></tr>
    <tr><td class="paramname">vector</td><td>Interrupt vector to deliver. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad7f4cf430c05d00d25c8c5fb5b030bf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7f4cf430c05d00d25c8c5fb5b030bf8">&#9670;&nbsp;</a></span>apic_setup_ap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apic_setup_ap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the Local APIC on an Application Processor (AP). </p>
<p>This function enables the Local APIC by setting the spurious interrupt vector register's enable bit, and lowers the Task Priority Register (TPR) to zero so that the AP can receive all interrupts.</p>
<p>It is typically invoked during AP startup after IDT installation, allowing the processor to handle interrupts and inter-processor IPIs.</p>
<dl class="section note"><dt>Note</dt><dd>This does not configure LAPIC timers or IPI handlers; it only ensures that the APIC is enabled and accepting interrupts.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="apic_8h.html#a7ba83fbfa8fda429adf009e0bfb6a02a" title="Write to a Local APIC register.">apic_write</a> </dd>
<dd>
<a class="el" href="lapic__timer_8h.html#abad6e91426bdfd1f569bf2cfbe386e49">APIC_SVR</a> </dd>
<dd>
<a class="el" href="apic_8h.html#a2545c1ddec7ab80d2de4699ac7f50233" title="Task Priority Register (TPR). Controls interrupt priority threshold.">APIC_TPR</a> </dd></dl>

</div>
</div>
<a id="a338fb9dae0af159d69fd10623f80efb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a338fb9dae0af159d69fd10623f80efb1">&#9670;&nbsp;</a></span>apic_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apic_write </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write to a Local APIC register. </p>
<p>Works in both xAPIC and x2APIC modes:</p><ul>
<li>In xAPIC mode, the register is memory‑mapped at the LAPIC base address.</li>
<li>In x2APIC mode, registers are written via MSRs at 0x800 + (reg &gt;&gt; 4).</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reg</td><td>Register offset (e.g. APIC_TPR = 0x80). </td></tr>
    <tr><td class="paramname">value</td><td>Value to write. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae432e81c207ce0b8e9c880bd3c89eb33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae432e81c207ce0b8e9c880bd3c89eb33">&#9670;&nbsp;</a></span>cpu_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t cpu_id </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the Local APIC ID of the current CPU. </p>
<p>In xAPIC mode this is an 8-bit value read from the LAPIC ID register. In x2APIC mode this is a 32-bit value read from MSR 0x802.</p>
<dl class="section return"><dt>Returns</dt><dd>uint32_t LAPIC ID of the current CPU. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>LAPIC IDs are assigned by hardware/firmware and may be sparse, non-contiguous, or not zero-based. </dd></dl>

</div>
</div>
<a id="a19b8b3ead84a068bb923f912b3cb6d6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19b8b3ead84a068bb923f912b3cb6d6c">&#9670;&nbsp;</a></span>get_lapic_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t get_lapic_address </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the physical address of the Local APIC MMIO region. </p>
<p>This is only valid when xAPIC mode is active. In x2APIC mode, LAPIC registers are accessed via MSRs instead of MMIO.</p>
<dl class="section return"><dt>Returns</dt><dd>uint64_t Physical address of the LAPIC MMIO base. </dd></dl>

</div>
</div>
<a id="a4b661f6d8fb7bf5b98900736716e6957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b661f6d8fb7bf5b98900736716e6957">&#9670;&nbsp;</a></span>logical_cpu_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t logical_cpu_id </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the OS-assigned logical CPU ID of the current CPU. </p>
<p>Logical CPU IDs are zero-based, contiguous indices used internally by the kernel. They are mapped to LAPIC IDs via cpu_id_mapping[].</p>
<dl class="section return"><dt>Returns</dt><dd>uint8_t Logical CPU ID of the current CPU. </dd></dl>

</div>
</div>
<a id="abce401f079aedc55879daff1d981fe74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abce401f079aedc55879daff1d981fe74">&#9670;&nbsp;</a></span>rdmsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t rdmsr </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>msr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a 64-bit Model Specific Register (MSR). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msr</td><td>The MSR address to read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint64_t The value read from the MSR. </dd></dl>

</div>
</div>
<a id="ab9e5a39ff990b4f143ec56a9915f97c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9e5a39ff990b4f143ec56a9915f97c1">&#9670;&nbsp;</a></span>wake_cpu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wake_cpu </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>logical_cpu_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a wake-up IPI to a target logical CPU. </p>
<p>This function is used to wake an Application Processor (AP) from a halted or waiting state. It resolves the kernel-assigned logical CPU ID into the hardware LAPIC ID and then sends a fixed-mode IPI using the predefined wake-up vector (APIC_WAKE_IPI).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">logical_cpu_id</td><td>Logical CPU ID (zero-based, contiguous index assigned by the kernel).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The Local APIC on the target CPU must already be enabled for the wake-up IPI to be accepted. This function assumes that LAPIC initialisation has been performed during CPU bring-up. </dd></dl>

</div>
</div>
<a id="a5c1212d5f2acb0c6b937827a58a4f995"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c1212d5f2acb0c6b937827a58a4f995">&#9670;&nbsp;</a></span>wrmsr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void wrmsr </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>msr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abe067e3cf6c101bb76e395bd916e2d9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe067e3cf6c101bb76e395bd916e2d9d">&#9670;&nbsp;</a></span>x2apic_enabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int x2apic_enabled </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if x2APIC mode is enabled. </p>
<p>Checks both CPUID feature flags and the IA32_APIC_BASE MSR to confirm whether x2APIC is active.</p>
<dl class="section return"><dt>Returns</dt><dd>int Non-zero if x2APIC mode is enabled, zero otherwise. </dd></dl>

</div>
</div>
<a id="a5fd8a52f0de9d5cb7f11abc96af02e04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fd8a52f0de9d5cb7f11abc96af02e04">&#9670;&nbsp;</a></span>x2apic_supported()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int x2apic_supported </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="apic_8c.html">apic.c</a></li>
    <li class="footer">Generated on Fri Sep 5 2025 23:05:57 for Retro Rocket Kernel by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

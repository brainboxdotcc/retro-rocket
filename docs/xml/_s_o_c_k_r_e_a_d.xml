<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="_s_o_c_k_r_e_a_d" kind="page">
    <compoundname>SOCKREAD</compoundname>
    <title>SOCKREAD Keyword</title>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><programlisting filename=".basic"><codeline><highlight class="normal">SOCKREAD<sp/>integer-variable,<sp/>variable</highlight></codeline>
</programlisting></para>
<para>Reads a value from an <bold>open TCP socket</bold> into <computeroutput>variable</computeroutput>. <linebreak/>
 The first parameter must be an <bold>integer variable</bold> containing the socket handle returned by <ulink url="https://github.com/brainboxdotcc/retro-rocket/wiki/CONNECT"><computeroutput>CONNECT</computeroutput></ulink>.</para>
<para>The <bold>semantics match</bold> <ulink url="https://github.com/brainboxdotcc/retro-rocket/wiki/INPUT"><computeroutput>INPUT</computeroutput></ulink>:</para>
<para><itemizedlist>
<listitem><para>The call is <bold>blocking</bold>: it waits until there is <bold>enough data</bold> to parse a valid value for the destination type.</para>
</listitem><listitem><para><computeroutput>variable</computeroutput> may be <bold>string</bold>, <bold>integer</bold>, or <bold>real</bold>.</para>
</listitem><listitem><para>If the incoming data does <bold>not</bold> form a valid number when an integer or real is expected, the destination is set to <bold>0</bold>.</para>
</listitem><listitem><para>Unlike <computeroutput>INPUT</computeroutput>, there is <bold>no echo</bold> (data comes from the socket, not the keyboard).</para>
</listitem></itemizedlist>
</para>
<para><blockquote><para>[!TIP] Press <computeroutput>CTRL+ESC</computeroutput> at any time to <bold>cancel</bold> waiting for socket input. <linebreak/>
 Without an error handler, the program <bold>terminates</bold>. <linebreak/>
 With an <computeroutput>ON ERROR</computeroutput> handler, control passes there instead. </para>
</blockquote></para>
<sect2 id="_s_o_c_k_r_e_a_d_1autotoc_md330">
<title>&lt;/blockquote&gt;</title>
<sect3 id="_s_o_c_k_r_e_a_d_1autotoc_md331">
<title>Examples</title>
<para><bold>Read a text line</bold> <programlisting filename=".basic"><codeline><highlight class="normal">CONNECT<sp/>S,<sp/>&quot;93.184.216.34&quot;,<sp/>80</highlight></codeline>
<codeline><highlight class="normal">REM<sp/>Ask<sp/>the<sp/>server<sp/>for<sp/>a<sp/>line,<sp/>then<sp/>read<sp/>it</highlight></codeline>
<codeline><highlight class="normal">SOCKWRITE<sp/>S,<sp/>&quot;HEAD<sp/>/<sp/>HTTP/1.0&quot;<sp/>+<sp/>CHR$(13)<sp/>+<sp/>CHR$(10)<sp/>+<sp/>CHR$(13)<sp/>+<sp/>CHR$(10)</highlight></codeline>
<codeline><highlight class="normal">SOCKREAD<sp/>S,<sp/>LINE$</highlight></codeline>
<codeline><highlight class="normal">PRINT<sp/>LINE$</highlight></codeline>
<codeline><highlight class="normal">SOCKCLOSE<sp/>S</highlight></codeline>
</programlisting></para>
<para><bold>Read a number</bold> <programlisting filename=".basic"><codeline><highlight class="normal">CONNECT<sp/>S,<sp/>&quot;192.0.2.10&quot;,<sp/>1234</highlight></codeline>
<codeline><highlight class="normal">REM<sp/>Peer<sp/>will<sp/>send<sp/>an<sp/>integer<sp/>in<sp/>ASCII,<sp/>e.g.<sp/>42<sp/>followed<sp/>by<sp/>newline</highlight></codeline>
<codeline><highlight class="normal">SOCKREAD<sp/>S,<sp/>N</highlight></codeline>
<codeline><highlight class="normal">IF<sp/>N<sp/>=<sp/>0<sp/>THEN</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PRINT<sp/>&quot;Invalid<sp/>or<sp/>zero<sp/>value<sp/>received&quot;</highlight></codeline>
<codeline><highlight class="normal">ELSE</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PRINT<sp/>&quot;Got:<sp/>&quot;;<sp/>N</highlight></codeline>
<codeline><highlight class="normal">ENDIF</highlight></codeline>
</programlisting></para>
<para><bold>Handle cancellation and errors</bold> <programlisting filename=".basic"><codeline><highlight class="normal">ON<sp/>ERROR<sp/>PROCnet_err</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CONNECT<sp/>S,<sp/>&quot;203.0.113.5&quot;,<sp/>7000</highlight></codeline>
<codeline><highlight class="normal">IF<sp/>S<sp/>&gt;=<sp/>0<sp/>THEN</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PRINT<sp/>&quot;Waiting<sp/>for<sp/>data<sp/>(CTRL+ESC<sp/>to<sp/>cancel)...&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SOCKREAD<sp/>S,<sp/>DATA$</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PRINT<sp/>&quot;Received:<sp/>&quot;;<sp/>DATA$</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>SOCKCLOSE<sp/>S</highlight></codeline>
<codeline><highlight class="normal">ENDIF</highlight></codeline>
<codeline><highlight class="normal">END</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">DEF<sp/>PROCnet_err</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>PRINT<sp/>&quot;Socket<sp/>error:<sp/>&quot;;<sp/>ERR$</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ON<sp/>ERROR<sp/>PROCnet_err</highlight></codeline>
<codeline><highlight class="normal">ENDPROC</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
<sect3 id="_s_o_c_k_r_e_a_d_1autotoc_md333">
<title>Notes</title>
<para><itemizedlist>
<listitem><para>Treat the socket as a <bold>byte stream</bold>; if you need to read multiple fields on one line, call <computeroutput>SOCKREAD</computeroutput> multiple times or define a simple protocol (for example, one value per line).</para>
</listitem><listitem><para>After <computeroutput>SOCKCLOSE</computeroutput>, the handle is invalid for further <computeroutput>SOCKREAD</computeroutput>/<computeroutput>SOCKWRITE</computeroutput>.</para>
</listitem><listitem><para>Use <ulink url="https://github.com/brainboxdotcc/retro-rocket/wiki/DNS"><computeroutput>DNS$</computeroutput></ulink> to resolve hostnames to IP strings for <computeroutput>CONNECT</computeroutput>.</para>
</listitem></itemizedlist>
</para>
<para><bold>See also:</bold> <linebreak/>
 <ulink url="https://github.com/brainboxdotcc/retro-rocket/wiki/CONNECT"><computeroutput>CONNECT</computeroutput></ulink> · <ulink url="https://github.com/brainboxdotcc/retro-rocket/wiki/SOCKWRITE"><computeroutput>SOCKWRITE</computeroutput></ulink> · <ulink url="https://github.com/brainboxdotcc/retro-rocket/wiki/SOCKCLOSE"><computeroutput>SOCKCLOSE</computeroutput></ulink> · <ulink url="https://github.com/brainboxdotcc/retro-rocket/wiki/INPUT"><computeroutput>INPUT</computeroutput></ulink> </para>
</sect3>
</sect2>
    </detaileddescription>
    <location file="docpages/basic-language-reference/keywords/SOCKREAD.md"/>
  </compounddef>
</doxygen>
